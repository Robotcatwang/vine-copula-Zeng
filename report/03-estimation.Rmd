---
title: "开题报告"
author: "Li"
date: "2019-04-15"
css: ./style/markdown.css
autoEqnLabels: true
eqnPrefixTemplate: ($$i$$)
linkReferences: true
bibliography: Bibfile.bib
notice: '@*'
csl: ./style/chinese-gb7714-2005-numeric.csl
link-citations: true
---



```{r setup, echo=F}

################# 第 3 章 R 程序代码  ####################


knitr::opts_knit$set(root.dir = getwd())
knitr::opts_chunk$set(echo = FALSE, results = 'hide')
knitr::opts_chunk$set(warning = FALSE, message=FALSE)
```

```{r prepare}
rm(list=ls())
options(digits=4)
options(scipen=100)
graphics.off()
Sys.setlocale("LC_ALL", "Chinese")
```




# 基于 GAS 模型的黄金期货收益率建模

## 数据来源

一、数据选取及意义

不同于国外期货的选择，以最近月份的期货合约每交易日的收盘价作为价格时间序列，由于我国期货合约
生命周期非无限性，使得其在达到某一特定交易日后，合约会平仓停止交易。因此期货合约相关数据无法
像股票市场一样得到一个连续的金融时间序列，即不具备连续性特征。并且上海期货交易所在同一个交易
日有数个黄金期货合约。黄金期货市场的成交量和持仓量则反映了投资者对新信息认同的差异。持仓量与
市场波动负相关，成交量与市场波动正相关。因此，本文选取的交易品种为上海期货交易所的黄金期货主
力合约。即选择在同一时间交易的不同交割月份合约中成交量与持仓量最大的合约，交易最为活跃的主力
合约作为期货交易数据标的。因为同时进行交易成交量与持仓量的大小能表示市场的交易活跃度、参与度
以及人气指标，那么黄金期货主力连续合约对市场交易状况有很好的代表性。并且由于收盘价是指某一期
货合约当日交易的最后一笔成交价格。结算价是指某一期货合约当日成交价格按成交量的加权平均价。因
此，本文以结算价为基础来计算期货市场价格的日间波动测度比较合理。

国外研究者表明，主力合约反映了主要的价格信息，能够作为期货价格的代表，采用主力合约价格构造连
续时间序列的优点是抓住了关键的期货价格信息。这样选取数据的优点是期货价格和现货价格比较接近，
同时还可以克服交割月交易量较小，数据不稳定的缺点。在单独研究产品期货价格的波动性时，经常可以
见到使用主力合约构建连续时间序列。而且所选择的黄金期货主力合约的交易量平均占当日所有黄金期货
合约交易量的80%以上，具有充分的代表性。

二、主力合约数据预处理

本文所收集的样本区间是2009年1月5日至2019年3月29日，总计2489个我国黄金期货主力合约。数据全部
来自于上海期货交易所官网(http://www.shfe.com.cn/)。设${R_t}$为第$t$期的结算价。正因为金融资
产的反复震荡给金融市场带来了风险，黄金期货市场价格的变动反映了市场对新信息的吸收，波动性展示
了其价格波动的剧烈程度，所以价格波动的分析与研究是测度风险的基础。且在探讨金融时间序列变化时
，为了消除数据的非平稳性，常常使用对数收益率：

$${r_t} = \ln {R_t} - \ln {R_{t - 1}}$$

其中， ${R_{t - 1}}$ 为上一期的结算价，通过计算，可以得到2488个我国黄金期货主力合约收益率的
时间序列，然后研究收益率的波动性。使用前2483个数据建立模型，预留后5个数据用作模型预测的对比
分析。

## 黄金期货收益率描述性分析

### 基本统计量计算 

数据基本统计量中，算数平均值反映整体水平，标准差刻画序列离散程度，经常作为衡量风险的依据；
偏度（Skewness）刻画样本分布密度能否满足对称分布于纵坐标轴两端，当偏度为0时，即样本分布密
度关于纵坐标轴对称，当偏度大于0时，则重尾在右边，即称右偏，反之，重尾在左边，即称左偏。峰
度（Kutosis）用以刻画样本分布曲线顶端尖峭或扁平程度，正态分布峰度为3，超过此值，序列呈现尖
峰、厚尾特点。

中国黄金期货主力连续合约日收益率序列基本描述统计量计算结果如下：

```{r import-data}
## 准备
rm(list=ls())
options(digits=4)
options(scipen=100)
graphics.off()
## path <- "F:/github_repo/gas-gold-Wei/" 
## setwd(path)
#Sys.setlocale('LC_ALL','C') 
Sys.setlocale("LC_ALL", "Chinese")


## 加载包
library(zoo)
library(forecast)
library(tseries)
library(xts)
library(ggplot2)
library(FinTS)
library(moments)
library(devtools)
library(FinTS)
library(GAS)
library(fBasics)
library(knitr)
library(timeDate)
library(timeSeries)

## 载入数据
dat=read.csv("./data/jiesuan.csv",header=T)
shibor<-dat[,2]
shibor<-shibor[1:2484]
shibor.date<-as.Date(dat[,1])
shibor.date<-shibor.date[1:2484]

#计算对数收益率
shibor.rt<-diff(log(shibor))
shibor.rt<-shibor.rt[1:2483]
shibor.rt = na.omit(shibor.rt)
```

```{r stat1, results='markup'}
shibor.rt1<-basicStats(shibor.rt)
shibor.rt2<- as.data.frame(t(shibor.rt1[c(7,14,15,16),]))
colnames(shibor.rt2) <- c("均值","标准差","偏态系数","峰态系数")

kable(shibor.rt2,row.names =F,align = "c", caption="样本描述性分析结果",
      longtable = TRUE, booktabs = TRUE, linesep="")
```

从表 \@ref(tab:stat1) 看出，对数收益率的偏度为`r shibor.rt2[1,3] `，峰度为 `r shibor.rt2[1,4]` ，
而正态分布的偏度和峰度分别为0和3，故对数收益率序列具有左偏性和尖峰性，初步判断不服从正态分布。

### 序列图

我国黄金期货主力合约对数收益率时序图如下：


```{r fig-ts1,eval=T,fig.cap = "我国黄金期货主力合约对数收益率时序图", dev='png'}
par(mfrow=c(2,1))
par(mar=c(2,4,1,2))
plot(shibor.date,shibor,type="l",xlab="日期",ylab="每日结算价")
plot(shibor.date[-1],shibor.rt,type="l",xlab="日期",ylab="我国黄金期货主力合约对数收益率",cex.main=0.95,las=1)
#显然具有波动应聚集的特征
```

由图 \@ref(fig:fig-ts1)可以看出，我国黄金期货主力合约每日结算价在2009-2013年波动幅度较大，在
2013-2019年波动幅度较平稳。对数收益率序列的方差随时间变化而变化，而且有时变化得十分剧烈。同
时，对数收益率的波动存在显著的波动集群效应，波动聚集性意味着大波动不是突然发生，而是逐步发生
的，即大波动发生前有相应信号出现，比如出现异常低的收益率。大波动后面跟随着大波动，小波动后跟随着小
波动，且大波动和小波动交替出现。这种现象说明黄金期货日收益率序列可能存在异方差性（即ARCH效应），后
文将作进一步验证。
 
### 黄金期货收益率序列基本检验

在对时间序列进行分析时，必须要进行平稳性检验。平稳性是指随时间移动，时间序列不会表现出明显
的变动趋势。若时间序列非平稳，导致发生伪回归，从而参数估计不准确，模型拟合效果不好。通过使
用适用于异方差场合的PP检验法(Phillips-Person
Test)对Shibor对数收益率序列进行检验发现，相关统计量对应的P值远小于0.05，表明该序列是平稳的,
满足进一步建模条件。 

```{r}
#平稳性检验
pp.test(shibor.rt)  #平稳
```

建立模型之前对基础数据进行正态性检验是十分必要的。首先可以通过计算对数收益率数据的直方图和QQ
图进行描述性分析。

```{r hist, fig.cap="我国黄金期货主力合约收益率频率分布直方图和正态Q-Q图", dev='png'}
par(mfrow=c(1,2))
#绘制直方图
hist(shibor.rt,main=NULL,breaks = 50)

#正态性检验
qqnorm(shibor.rt,main =NULL)
qqline(shibor.rt)                #QQ图检验非正态
```

图 \@ref(fig:hist) 的直方图和QQ图也显示对数收益率序列不服从正态分布。直方图中，对数收益率序
列的尾部明显长于普通正态分布，具有金融序列的尖峰厚尾特征。QQ图可以直观的验证一组数据是否服从
正态分布，图中对数收益率的散点明显偏离代表正态分布的直线，且在左侧表现出散点图分布下摆的趋势，
右侧表现出分布上扬的趋势，说明该序列具有明显的尖峰厚尾特征。

根据以上分析，我们可以考虑我国黄金花期货价格收益率序列服从非对称分布，例如student-t分布、GED
分布、skewed student-t分布、skewed GED分布等。
 
```{r}
#正态性检验
jarque.bera.test(shibor.rt)    #JB检验非正态

```

以上均是描述性分析得出的初步判断，为了更加科学地判断收益率序列的特征，采用J-B（Jarque-Bera）
统计量对收益率数据进行正态性检验，统计量J-B对应的p值小于2e-16,小于显著性水平0.05，故拒绝原假
设，验证了之前收益率数据不服从正态分布的判断。


### 自相关和偏相关检验

```{r acf-pacf, fig.cap="我国黄金期货主力合约收益率自相关图和偏自相关图", dev='png'}
#自相关性检验
par(mfrow=c(2,1)) 
acf(shibor.rt,main="",xlab="滞后期",ylab="ACF")#画自相关图
title(main = "(a)the ACF of Return",cex.main=0.95)
pacf(shibor.rt,main="",xlab="滞后期",ylab="PACF",las=1)#画偏自相关图
title(main="(b)the PACF of Return",cex.main=0.95)
```

```{r}
acf(shibor.rt,plot = F,lag.max = 15)
pacf(shibor.rt,plot = F,lag.max = 15)
Box1=Box.test(shibor.rt,lag=10,type = "Ljung")
library(forecast)
library(stats)
fit1=Arima(shibor.rt,order = c(1,0,1))
fit1.res=c("fit1",AIC(fit1),BIC(fit1))
fit2=arima(shibor.rt,order = c(1,0,2))
fit2.res=c("fit2",AIC(fit2),BIC(fit2))
fit3=arima(shibor.rt,order = c(2,0,1))
fit3.res=c("fit3",AIC(fit3),BIC(fit3))
fit4=arima(shibor.rt,order = c(2,0,2))
fit4.res=c("fit4",AIC(fit4),BIC(fit4))
res1=data.frame(fit1.res,fit2.res,fit3.res,fit4.res)
res1
auto.arima(shibor.rt)
fit111=arima(shibor.rt,order = c(1,0,1))
resi<-resid(fit111,standardize=F)
res.ts<-ts(resi,frequency = 250)
Box2=Box.test(resi,lag=10,type = "Ljung")
```

```{r}
fit=stats::arima(shibor.rt,order = c(1,0,1))
shibor.rt.r<-stats::residuals(fit)
```

对我国黄金期货主力合约收益率进行自相关检验，这里分别运用自相关系数、偏自相关系数和Ljung-Box Q
统计量对主力合约对数收益率序列进行自相关分析。

Ljung-Box Q统计量的值为 `r Box1$statistic` ，对应p值为 `r round(Box1$p.value, 4)` ，远小于
显著性水平0.05，故收益率序列为非白噪声序列，具有较强的自相关性，需要进一步提取观察值序列的相
关信息。综合之前的平稳性检验，可以判断对数收益率序列是一个蕴涵相关信息的平稳序列，故建立ARMA(p,q)
模型来拟合该序列的变化过程。

```{r residual, fig.cap="我国黄金期货主力合约收益率残差序列图", dev='png'}
plot(shibor.date[-1],shibor.rt.r,type="l",
     xlab="日期",ylab="残差",cex.main=0.95,las=1)
```

图 \@ref(fig:acf-pacf) 中的自相关系数和偏自相关系数均显示出拖尾的性质，考虑到模型的简洁性，
本文将ARMA模型参数p,q的取值设置为1，1，尝试使用ARMA(1,1)、ARMA(1,2)、ARMA(2,1)、ARMA(2,2)对
序列进行拟合。最终根据参数显著性检验以及AIC和BIC准则选择最优模型为ARMA(1,1)，其AIC和BIC值最
小，分别为 `r fit$aic` 和 `r BIC(fit)` ，因此得到自回归移动平均模型的数学表达式为：
\[{x_t} =  - 0.820{x_{t - 1}} + {\varepsilon _t} + 0.865{\varepsilon _{t - 1}},t \in 1,2,...,T\]
根据已经得出的参数估计值，可以获得ARMA(1,1)模型的残差序列，如图\@ref(fig:residual)所示。对其
进行白噪声检验，Ljung-Box Q统计量显示残差序列无自相关性，p值为 `r Box2$p.value`，
小于0.05的显著性水平。

```{r}
#ARCH效应检验
ArchTest(shibor.rt.r,lag=12)  #存在ARCH效应
```

在金融中，波动率（volatility）指的是随着时间变化的资产收益率的波动程度。波动率目前还没有统一
的定义。通常是以平均（对数）收益率为基准，用（对数）收益率的标准差（或方差）来度量。理论上，
将（对数）收益率看成是随机变量，因而可以用其标准差或方差来度量（对数）收益率取值变化的程度。
观察图 \@ref(fig:residual)中的残差序列可以发现，虽然其波动是平稳的，但在2009-2013年时间段波
动持续偏大，在其余时间段波动持续偏小，呈现出聚集效应，故接下来进行ARCH效应检验。两种常用的ARCH
检验统计方法是Portmanteau Q检验和LM检验。ARCH效应检验的原假设为：残差序列中直到p阶都不存在
ARCH效应。ARCH效应的存在不导致OLS估计无效，但会降低估计的有效性[@徐畅2019]。这里使用
Portmanteau检验对收益率数据进行分析。根据R软件分析结果可知P值小于2e-16，远小于0.05，故拒绝原
数据，即认为残差平方序列自相关，残差序列存在ARCH效应，需要进一步构建GARCH模型。

```{r arma-fit, fig.cap="残差平方相关图", dev="png"}
#拟合GARCH
#残差平方的自相关性分析
par(mfrow=c(2,1))
rt.square<-shibor.rt.r^2
acf(rt.square,main="",xlab="lag(c)",ylab="ACF",las=1)#画自相关图
title(main = "(c)the ACF of resi Square",cex.main=0.95)
pacf(rt.square,main="",xlab="Lag(d)",ylab="PACF",las=1)#画偏自相关图
title(main = "(d)the PACF of resi Square",cex.main=0.95)
Box.test(rt.square,lag = 10,type = "Ljung")
```

## 黄金期货市场收益率模型构建

### 基于黄金期货市场收益率建模

本文之前的分析指出黄金期货对数收益率序列具有波动特征，在金融时间序列的波动率分析中，波动率是
指金融市场中价格偏离均值轨迹的程度。实际中，波动率是无法直接被观测，而且会随着时间而变化呈现
出一定的波动特征。而传统的GARCH模型均是在假定某个单一分布的前提下进行的，并对ARMA和GARCH分开
建模，从而使得参数估计具有片面性和不准确性。而GAS模型可同时实现对序列均值和波动率的刻画，捕
捉波动更敏感，故接下来使用GAS模型和GARCH模型进行序列拟合，从而使得模型精度更高。

由于高阶GARCH模型会导致ARCH项和GARCH项系数过多，不利于模型稳定和参数估计，而且之前大量学者的
研究表明，低阶GARCH能够刻画时间序列的异方差现象，且在精度方面不存在太大的差距，故设置ARCH项
和GARCH项的阶数均为1，即GARCH(1,1)结构。

在相关文献中[@Chen2019]，通常将GAS(1,1)模型中条件t分布的波动率自然地视为时变参数，但是，学生-t分布
的位置和形状参数是否随时间变化需要通过似然比检验(LRT)来确定。似然比检验（LRT）方法用来比较两个模型
，看是否可以用一个简单模型来替代一个复杂模型。原假设为：${H_0}:u = {u_i}$，备择假设为：${H_1}:u = {u_{i + 1}}$，i=0,1,2,3，
这里${u_i}$表示为一系列时变参数的嵌套模型。也就是说，${u_0}$是位置参数、尺度参数和形状参数均不被包
含的模型，${u_1}$只有随时间变化的波动率参数，${u_2}$模型涵盖波动率参数和形状参数，${u_3}$模型表示波
动率，形状和位置的参数均随时间变化。很明显，${u_0} \subset {u_1} \subset {u_2} \subset {u_3}$，
模型中所含参数越多，对数似然值越大。${\rm{LRT=2*(lnL1-lnL2)}}$，其中${\rm{lnL1}}$为复杂模型的对数似
然值，${\rm{lnL2}}$为简单模型的似然值对数。在样本量相当大的情况下，LRT近似服从卡方分布，自由度等于
复杂模型中的模型参数个数与简单模型的参数个数之差。表13给出了基于样本内数据集的所有LRT结果。

```{r fig13,echo=FALSE,fig.cap="LRT对GAS（1,1）模型的测试结果",cache=F,dev="png",results='markup'}
knitr::include_graphics("./LRT.png")
```

在5%显着性水平下，模型${u_2}$和${u_3}$相比，p值大于5%，不拒绝原假设，差异不显著，说明可以用${u_2}$
代替${u_3}$，位置参数不是合适的时变参数，也因为此时的GAS模型是再对原利率序列建立ARMA(1，1)模型后对
残差序列建模，此时均值恒定。但模型${u_1}$和${u_2}$相比，LRT值与1231相比小很多，且多篇论文设置
${f_t} = \ln {\sigma _t}$[@王杰2017]或者${f_t} = \sigma _t^2$，
同时联系GARCH模型为GAS的特例，因此将GAS(1,1)模型中条件t分布的波动率设为时变参数，这里令${f_t} = \ln {\sigma _t}$。当${f_t}$表示方差或者对数方差时，GAS框架将是比GARCH类模型更容易扩展的模型。

在分布类型的选取方面，为了对比普通GARCH模型和GAS模型及其特例的拟合效果，首先针对普通GARCH模
型对黄金期货价格收益率进行拟合。正如前面所知，由于黄金期货价格收益率序列存在偏态和尖峰厚尾特
征，表现出明显的非正态迹象，为了更好的描述收益率序列的厚尾性，因此分布类型依次选取传统的正态
分布、对厚尾特征刻画更具灵活性的广义t分布和广义误差分布，以及它们的偏态分布，即“norm”、"t"
、"ged"、“snorm”、"st"、"sged"共6种。本文选用R软件的GAS包作为计量工具。对平稳不相关但具有条件
异方差性的残差序列共构建17个模型，具体结果详见模型估计结果比较，并运用AIC、BIC值最小化，
对数似然值最大化及$\alpha  + \beta  < 1$的准则来选择最优的模型。

### 最优模型选择

因为在不同模型中，对于AIC、BIC的定义不一样。AIC是衡量统计模型拟合优良性的一种标准，由日本统计学家赤池弘次在1974年提出，它建立在熵的概念上，提供了权衡估计模型复杂度和拟合数据优良性的标准。在GARCH类中，AIC一般定义为$AIC=(2k-2\ln(L))/n$，其中k为模型参数个数，L是似然函数，n是观测值数目。而在GAS类中，AIC定义式为$AIC=2k-2\ln(L)$。BIC（Bayesian InformationCriterion）贝叶斯信息准则与AIC相似，用于模型选择，1978年由Schwarz提出。训练模型时，增加参数数量，也就是增加模型复杂度，会增大似然函数，但是也会导致过拟合现象，针对该问题，AIC和BIC均引入了与模型参数个数相关的惩罚项，BIC的惩罚项比AIC的大，考虑了样本数量，样本数量过多时，可有效防止模型精度过高造成的模型复杂度过高。在GARCH类中，BIC定义式为$BIC=(k\ln(n)-2\ln(L))/n$，而在GAS类为$BIC=k\ln(n)-2\ln(L)$。因此将GAS类模型结果中的AIC和BIC变换后，同等量级的结果如下：

```{r fig8,echo=FALSE,fig.cap="模型估计结果比较表1",cache=F,dev="png",results='markup'}
knitr::include_graphics("./SELECT1.png")
```

β1系数均通过了显著性检验且系数值较大，均大于系数α1，表示流动性波动中自身前期波动对条件方差的
贡献要远高于外部冲击对条件方差的影响，也即表明市场流动性波动具有很强的持续性影响；系数α1、β1
都显著为正，表明过去的波动对后期波动有正向递减的影响（即波动集聚性），即在局部时间内各期的波
动易于同时保持较高或较低水平。GARCH、EGARCH模型的α1+β1系数和接近于1，说明期货市场在某时刻的
收益冲击具有持续性的影响，波动率的衰减较慢。又说明外生干扰不仅对中国黄金期货市场的短期有强作
用，而且会长期作用于未来无限长期的波动。所以说我们能够认为我国黄金期货市场震荡异常剧烈，市场
风险很大。这是显然的，我国虽然是黄金生产和消费大国，但是在黄金定价中的国际话语权不足，国际黄
金价格的剧烈波动、美元汇率的变动和国际政治局势的变幻莫测等经常对我国黄金期货市场造成很大冲击
[@曹辉2012]。

黄金期货收益率对正的和负的“扰动”反应是不一样的，下跌和上涨幅度相同情况下，上涨带来的波动比下跌更
为剧烈，说明了期货波动的不对称性，即杠杆效应。通常情况下表现为利空信息总是没有利好信息对
市场的作用大，此效应也常被通俗地称为“非对称性”。这种金融市场中的杠杆效应，反映出波动率与外生
干扰两者间的不对称。负的外生干扰对波动影响更大，一定程度上可以反映出黄金期货市场参与者风险承受能
力较高（即风险喜好）的特点。例如在AIC、BIC较优的EGARCH-t中，$\alpha$的估计值为0.010289，非对称项$\gamma$
为0.108077，当出现“利多消息”时，${\mu_{t-1}}>0$，利多消息对条件方差的对数有一个0.118366（0.010289
+0.108077）倍的冲击；当出现“利空消息”时，${\mu_{t-1}}<0$、对于条件方差对数带来的冲击大小为-0.0977
88（0.010289+0.108077*（-1））倍，结果同样说明，黄金价格波动具有杠杆效应，“利多消息”与等量的“利空
消息”相比，能够产生更大的波动。

根据参数显著性检验、极大似然值、AIC、BIC的方法，GARCH类中部分模型的AIC、BIC和极大似然值高于GAS类，
但存在参数检验不通过（对于GARCH族模型，此处只列举方差方程的系数，均值方程中也存在部分参数检验
未通过），GAS-norm模型也存在参数检验不通过，因此其中最优模型为GAS-t模型，且参数均通过了检验，满足
参数的约束条件。另外模型回归的对数似然值较高，模型具有一定的可信度[@赵鹏举2019]。

这四种边缘分布类型刻画肥尾和偏斜特征的能力各不相同：正态分布没有形状参数，既无法捕捉肥尾特征
，也无法捕捉偏斜特征；t分布有一个控制峰度的形状参数，虽然可以捕捉肥尾特征，但无法捕捉偏斜特
征；偏斜正态分布有一个控制偏度的形状参数，虽然可以捕捉偏斜特征，但无法捕捉肥尾特征；偏斜t分
布有两个分别控制偏度和峰度的形状参数，能够同时刻画偏斜和肥尾特征。由上文偏度系数和峰态系数计
算可知，该序列的偏态并不严重，结果也说明了GAS-t优于GAS-sst。

从波动模型系数看，GAS-t模型的自回归系数大多高于上文的GARCH类模型，其原因在于GAS-t模型对收益和
波动都采用了厚尾分布，不时出现的异常观测值被看作来自分布尾部而不是波动水平发生了变化，厚尾分
布对波动分布尾部性的控制，凸显了波动的持续性。另一个特征是GAS-t波动中的更新项系数也显著大
于GARCH类模型，进一步说明得分驱动设定波动模型更新项的优势，包含了更多影响未来波动的
信息[@Catania2016]，对收益数据和已实现波动率观测值的充分利用。下面将再针对分布形式为t分布的GAS
类模型在不同的显著性水平下展开讨论，以便研究我国黄金期货市场的风险波动。

### 模型参数估计和解释

由上文LRT检验可知，在本文中，研究对象为黄金期货的日波动率。因此假定只有波动性是时变的，学生t分布的GAS模型在单变量随机变量$y_t$，t分布的位置${\mu _t}$，规模${\phi _t}$，自由度$v_t$，${\theta _t} = {({\mu _t},\phi _t^2,{v_t})^T}$的情况下。t分布密度函数为：
$$p({y_t};{\theta _t}) \equiv \frac{{\Gamma (\frac{{{v_t} + 1}}{2})}}{{\Gamma (\frac{{{v_t}}}{2}){\phi _t}\sqrt {\pi {v_t}} }}{(1 + \frac{{{{({y_t} - {\mu _t})}^2}}}{{{v_t}\phi _t^2}})^{ - \frac{{{v_t} + 1}}{2}}}$$

当学生t具有足够的厚尾时，与学生t分布相对应的分数具有抑制极端观测对未来波动性影响的优势。分数
向量为：${\nabla _t}({y_t},{\theta _t}) = {(\nabla _t^\mu ,\nabla _t^{{\phi ^2}},\nabla _t^v)^T}$，
因为一般取$\gamma$取0便于计算，GAS(1,1)-st服从：

$$\left\{ {\begin{array}{l}
{{\theta _{t}} \equiv \Lambda ({{\tilde \theta }_{t}})}\\
{{\tilde \theta }_{1}}={ \theta}\\
{{{\tilde \theta }_{t + 1}} \equiv \kappa  + AJ {{({{\tilde \theta }_t})}^T}{\nabla _t}({y_t},{\theta _t}) + B{{\tilde \theta }_t}}
\end{array}} \right.$$

${\theta }_{t}$是需要建模的时变参数，其参数空间一般是受约束的，而且不同参数可能具有不同
的约束。可能是无约束的均值、取值为正数的方差和标准差、取值在-1到1之间的线性相关系数等。
${\tilde \theta }_{t}$是${\theta}_{t}$的再参数化，是无约束的时变参数。为了便于时变参数建模，
GAS模型不是直接对受约束的时变参数建模，而是直接对无约束的时变参数建模，从而间接实现对受约束的
时变参数建模。$\theta$同时也作为序列的初始值，这是一个非常重要的技术性设定，解决了初始值设定
的难题，同时使得时变参数演化过程更容易退化成静态形式。$\Lambda$为转换函数，用于将无约束的时变
参数转换为原始的受约束的时变参数。对于不同的参数空间，转换函数的设定肯定不同，而对于相同的参
数空间，转换函数的设定也可能不同。对于给定的参数空间，转换函数有一些常见的设定：当$\theta  \in (a,b)$时，可以设定$\wedge (x) = a + (b - a)/[1 + \exp ( - x)]$；当$\theta  \in (a, + \infty )$时，
可以设定$\wedge (x) = a + \exp (x)$；当$\theta  \in ( - \infty ,b)$时，可以设定$\wedge (x) = b - \exp ( - x)$，J是雅克比矩阵为：

$$J({\tilde \theta _t}) = \left( {\begin{array}{ccc}
1&0&0\\
0&{\exp (\tilde \phi _t^2)}&0\\
0&0&{\exp ({{\tilde v}_t})}
\end{array}} \right)$$

而GAS-st中可变的无条件参数为此时退化为静态的t分布的位置为-1.226707e-04，波动性为8.127517e-05和自
由度（形状参数）为7.999988e+00，np=9为估计参数的数量，llk=5624.475为极大似然估计值，其中，A控制时变参数的时变性，一般要求A非负：当A越大时，时变参数的时变性越强；当A越接近0时，时变参数的时变性越
弱；当A等于0时，时变参数失去动态性。B参数控制时变参数的集聚性和均值回复性，一般要求B在0到1之间：
当B越接近1时，时变参数的集聚性越强，而均值回复性越弱；当B越接近0时，时变参数的集聚性越弱，而均值
回复性越强；当B等于1时，时变参数呈现随机游走；当B等于0时，时变参数呈现水平上下变动。

前文已经介绍系数矩阵A、B是通过网格搜索来确定初始值的，A是GAS模型中用于更新递归中的条件得分的
系数矩阵，B也是维度为3*3的自回归系数矩阵，为了提高GAS(1,1)-t模型的计算稳定性并减轻计算负担，
我们假设系数矩阵A和B是对角矩阵，并且将与固定参数相对应的对角元素的某些分量设置为零。因此，通
过对数似然函数的数值最大化获得了GAS模型中的未知参数。参数估计结果见下表。
```{r}
InSampleData = shibor.rt.r[1:1733]
OutSampleData = shibor.rt.r[1734:2483]

herspec=UniGASSpec(Dist="std",ScalingType="Identity",GASPar=list(location=TRUE,scale=TRUE,shape=TRUE))

herfit=UniGASFit(herspec,data=InSampleData,fn.optimizer = fn.optim, Compute.SE = TRUE)
```

```{r fig16,echo=FALSE,fig.cap="最佳模型估计结果",cache=F,dev="png",results='markup'}
knitr::include_graphics("./model.png")
```

从表中，我们发现分布形式为t分布的GAS模型的估计参数在5％的水平上几乎具有统计意义，但是存在一些
例外参数${\kappa _\mu }$。所有随时间变化的参数均由缩放分数函数及其自身的一阶滞后参数决定。由于
系数${a_\mu},{a_\phi},{a_v}$、${b_\mu},{b_\phi},{b_v}$都足够大，当A越大时，时变参数的时变性越
强。当B越接近1时，时变参数的集聚性越强，表明该模型捕获了强大的波动且具有持久性。

GAS模型在模型的形式规范方面具有一定的灵活性，同时未知参数的估计可以基于标准似然推理，不需要
计算密度或者基于模拟的方法，时变参数是由预测对数似然函数的得分驱动的。使用得分直接作为更新机
制是很直观的，因为它可以被看作是牛顿-拉弗森更新，为下一个时期提供了更好的拟合，并同时取决于
过去和当前的时间段。基于学生-t分布的GAS模型很好的改善了样本内的拟合情况，从Akaike信
息准则（AIC）可以较好地看出这一点。此外，估计自由度参数7.98也比较小，更加表明了肥尾分布的存在
，学生t分布也就更加适合。

```{r fig10,echo=FALSE,fig.cap="波动率拟合图",cache=F,dev="png",results='markup'}
knitr::include_graphics("./vol.png")
```

如图所示，通过对不同时刻波动率的表现特征发现，从2009年1月5日起，在前20天左右，即2009年2月，
出现较小幅度的波动，从我国黄金期货价格来讲，受到当时国际金价作用，自上市之日起一路下跌，之后
黄金期货价格开始震荡上涨，这主要是因为2008年9月雷曼兄弟宣告破产使金融危机深化而导致的。同时
，美联储为了应对金融危机而实施量化宽松政策导致美元贬值，作为避险资产的黄金价格逐步攀升，黄金
期货价格持续增加，一直持续到2009年年底，即第200天左右。

之后，由于相关部门并没有及时采取相应措施，使得黄金期货市场经历了一场剧烈的波动，导致黄金期货
价格飙升。从第653天，价格创历史新高，即直到2011年9月6日达到最高每克395.25元，达到历史最高水
平，此时黄金期货价格持续上涨。但在第777天左右，即2012年3月15日，我国黄金期货价格急速下降，每
克仅336.85元，波动率陡增。而且成交量一直处于低迷状态，仅仅有两三万手的水平，市场流动性非常差
，上海期货交易所分别于2012年的6月（即第850天左右）和9月（即第910天左右）两次下调期货交易手续
费来调动黄金期货市场活跃性。但是这些措施所取得的效果甚微，使得黄金期货价格时大时小，波动持续
发生。

2013年为黄金期货市场的转折点，美国经济复苏，使大家对黄金期货的保值避险需要降低，给其价格造
成下行压力，在黄金期货价格下降的同时成交量大幅增加。在第1003天左右，即2013年2月21日，黄金期
货价格跌至谷底，最低每克319.92元，致使波动率陡增。此后，2013年4月18日，价格迎来新一轮暴跌，
仅为每克271.48元，此时整个金融市场也较为动荡。为了稳定市场风险，“夜盘交易”制度于2013年7月起
实施，“夜盘交易”时间很好地覆盖了国际市场最活跃时间，这一点大大降低了隔夜交易风险，市场活跃度
得到明显提高[@Mcaleer2008]。 

2014年5月（即第1310天左右），国务院颁布了《国务院关于进一步促进资本市场健康发展的若干意见》
中再次强调商品期货的作用，提倡充分发挥其风险控制以及价格发现作用。随后，在2015年4月，由上期
所发布的《关于印发和修订案的公告》中对我国标准黄金期货合约做了相关调整。自2015年后，国际金价
大幅飙升，纽约市场的黄金价格从每盎司1200美元一路上涨，不到一个月已接近突破1300美元关口。统计
显示，2015年纽约市场的黄金期货价格已累计上涨9.3%[@郭泽宇2010]。而因为我国金融理论的创新和金融
管制放松这一系列政策的落实，我国金融市场的流动性被极大促进，我国黄金期货市场趋于平稳状态，市场
机制逐渐趋于成熟。

祸不单行，伴随着2009年始于希腊的欧洲主权债务危机事件不断发酵，2016年英国就“脱欧”问题实行公投
以来，一系列的事件加剧了全球经济衰退的趋势，给金融市场带来了难以估计的危害，加大了金融市场的
风险，我国黄金期货市场也未能幸免，导致波动率陡增[@黄健柏2018]。所以，准确把握黄金期货市场波动
特征与风险，可为各方参与者提供交易决策上的理论参考，有助于发挥该市场风险管理与价格发现作用。 


<!--# 参考文献 {-}-->
[//]: # (\bibliography{Bibfile})
